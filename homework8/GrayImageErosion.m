function output=GrayImageErosion(input,K,Kc,showImg)
if ~exist('showImg') 
    showImg=0;
end
[im_height,im_width]=size(input);
% Find the coordinate where '1' exists
[Krow,Kcol]=find(K);
Krow=Krow-Kc(1); % Relative position which kernel center is at (0,0)
Kcol=Kcol-Kc(2);

min_h=-min(Krow); % ^ ???????(3,3)??????????? ??????(?? ?????????)
max_h=max(Krow); % v
min_w=-min(Kcol); % < ???????(3,3)??????????? ??????(?? ?????????)
max_w=max(Kcol); % >

im_tmp=255*ones(im_height+min_h+max_h, im_width+min_w+max_w); 

im_tmp(min_h+1:min_h+im_height, min_w+1:min_w+im_width)=input; %???????? ?????? input ???????????(???? lean ??? row,cloume ????? ????)

output=zeros(im_height, im_width); %?????????512*512? lean ??? ???????
% Process for dilation

for c=1:im_width
    for r=1:im_height
        x=c+Krow+min_h;
        y=r+Kcol+min_w; %??? 1 ??,????????? x=0 ????,??? 1 
        abc=(x-1)*size(im_tmp,1)+y; 
        %??? lean ???? 0-255 ?????? kernel ???? ?????????? ---by ?? umbra:U[f]?? F*E"" 
        output(r,c)=min(im_tmp(abc));%????????,??? 21 ? kernel ??? lean ??? ?????????
    end
end
